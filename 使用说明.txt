# micro:bit 多功能手表（计步/组队/摩斯/打砖块）使用说明书
**适配项目**：`microbit-team-step-game`
**硬件兼容**：micro:bit V1 / V2
**代码版本**：完整版（防抖计步+无按键冲突+低电量提醒）

## 一、 设备准备清单
### 1.1 必备设备
| 设备名称 | 规格要求 | 用途说明 |
|----------|----------|----------|
| micro:bit 主板 | V2 | 核心控制设备，运行程序 |
| micro-USB 数据线 | 标准安卓接口 | 连接电脑烧录代码、供电 |
| 电脑/平板 | Windows/macOS/iOS/Android | 用于代码编辑与烧录 |

### 1.2 推荐配件
| 配件名称 | 规格要求 | 用途说明 |
|----------|----------|----------|
| micro:bit 电池盒或手表扩展板 | 3节7号电池供电 | 摆脱数据线，便携使用 |
| micro:bit 专用表带 | 适配主板尺寸 | 固定主板，手表化佩戴 |
| 多块 micro:bit 主板 | 同版本均可 | 实现多人组队功能 |

## 二、 代码烧录与上传步骤
本项目代码基于 **micro:bit MakeCode 平台**开发，支持多种烧录方式，以下为优先级排序的三种方法，新手优先选择方法一。

### 2.1 方法一：MakeCode 网页版烧录（推荐，零门槛）
1.  打开浏览器，访问 micro:bit 官方编程平台：[https://makecode.microbit.org/](https://makecode.microbit.org/)
2.  点击左上角「**New Project**」，输入项目名称（如 `microbit-watch`），进入编辑界面。
3.  删除编辑区默认代码，将项目仓库中的 `main.ts` 代码**完整复制并粘贴**到编辑区。
4.  使用 micro-USB 数据线连接 micro:bit 主板与电脑，电脑会自动识别出名为 `MICROBIT` 的可移动存储设备。
5.  点击网页右上角「**Download**」按钮，生成并下载 `.hex` 格式的代码文件。
6.  将下载好的 `.hex` 文件**拖拽至 `MICROBIT` 存储设备根目录**，主板黄色指示灯闪烁即表示烧录中。
7.  指示灯停止闪烁后，代码烧录完成，主板自动重启并运行程序，拔下数据线即可使用。

### 2.2 方法二：本地文件直接烧录（适合已下载 `.hex` 文件）
1.  从 GitHub 项目仓库下载最新版 `.hex` 代码文件。
2.  用数据线连接 micro:bit 与电脑，识别出 `MICROBIT` 存储设备。
3.  将 `.hex` 文件复制到 `MICROBIT` 根目录，等待指示灯闪烁完成，烧录成功。

### 2.3 方法三：MakeCode 离线版烧录（适合频繁调试）
1.  从 MakeCode 官网下载并安装离线编辑器：[https://makecode.microbit.org/offline-app](https://makecode.microbit.org/offline-app)
2.  打开离线编辑器，导入项目代码或粘贴代码至编辑区。
3.  重复 **2.1 步骤 4-7**，完成烧录。

### 2.4 烧录注意事项
1.  烧录前确保主板供电正常，数据线连接牢固，避免因接触不良导致烧录失败。
2.  无需在 `MICROBIT` 设备中新建文件夹，直接拖拽 `.hex` 文件即可，主板会自动识别执行。
3.  若烧录后主板无响应，可拔下电源等待 5 秒后重新上电，或重新烧录代码。

## 三、 开机初始化流程
主板上电后，程序自动执行初始化流程，无需手动操作：
1.  屏幕依次显示欢迎语 `Hello` → 笑脸图案 → 队名 `turtle`。
2.  自动初始化无线电模块，默认频道 `1`，发送组队申请信号。
3.  初始化计步器参数，步数清零，进入**待机状态**，所有功能可正常使用。

## 四、 功能优先级与总览
程序采用**功能优先级机制**，避免操作冲突，优先级从高到低排序如下：
`打砖块游戏模式 > 组队计步功能 > 摩斯密码功能 > 表情包/环境检测功能`

### 核心功能清单
| 功能模块 | 核心特性 |
|----------|----------|
| 精准计步 | Z轴加速度防抖算法，单次迈步仅计1步；10/50/100步里程碑奖励；组队步数同步 |
| 组队通信 | 无线电自动组队；全队步数汇总；队友里程碑实时祝贺 |
| 摩斯密码 | A键发点/B键发划；静音模式切换；历史记录缓存（最多10条） |
| 打砖块游戏 | 三击A键启停；得分统计+难度升级；50分胜利通关机制 |
| 环境检测 | 温度/亮度实时采集；短按B键查看个人步数 |
| 低电量提醒 | 电量＜2.0V时自动触发声光警报，提前预警关机风险 |

## 五、 详细操作指南
micro:bit 主板共 3 个操作按键（A 键、B 键、AB 组合键），所有功能通过**短按/长按/连击**实现，分为「游戏模式」与「日常模式」，操作逻辑清晰无冲突。

### 5.1 模式一：打砖块游戏模式
#### 5.1.1 模式启停
- **开启**：快速连续按压 **A 键 3 次**，屏幕显示启动图案，进入游戏模式。
- **关闭**：游戏中快速连续按压 **A 键 3 次**，游戏终止，恢复日常模式。

#### 5.1.2 游戏操作
| 按键 | 操作功能 |
|------|----------|
| A 键 | 游戏挡板向左移动一格 |
| B 键 | 游戏挡板向右移动一格 |

#### 5.1.3 游戏规则
1.  小球自动反弹，触碰挡板得分 +1，屏幕实时显示当前分数。
2.  累计得分每满 10 分，小球速度自动提升，触发难度升级提示音。
3.  得分达到 50 分：触发胜利动画与音乐，自动退出游戏，分数清零。
4.  小球掉落至屏幕底部：触发失败动画与音乐，自动退出游戏，分数清零。

### 5.2 模式二：日常使用模式（开机默认）
日常模式为程序默认模式，退出游戏后自动切换至此模式，所有计步、通信功能均在此模式下生效。

#### 5.2.1 B 键操作（核心计步/检测键）
| 操作方式 | 触发功能 | 反馈说明 |
|----------|----------|----------|
| 短按（＜0.5s） | 显示个人当前步数 | 屏幕显示 `STEP:XXX`，2秒后自动清空 |
| 长按（＞1s） | 依次触发「温度检测→亮度检测→组队信息查看」 | 1. 温度检测：显示 `XX℃` <br> 2. 亮度检测：显示 `XXL` <br> 3. 组队信息：显示 `T:X人 ALL:XXX步`；未组队显示「未组队」 |

#### 5.2.2 A 键操作（摩斯密码/模式切换键）
| 操作方式 | 触发功能 | 反馈说明 |
|----------|----------|----------|
| 短按（＜0.8s） | 发送摩斯密码「点（·）」 | 屏幕显示点图案，非静音状态下播放提示音，记录至历史缓存 |
| 长按（＞1s） | 切换摩斯密码静音模式 | 1. 开启静音：显示静音图标，右上角指示灯常亮 <br> 2. 关闭静音：显示声音图标，右上角指示灯熄灭 <br> 切换后自动显示个人步数 |
| 三击 | 切换打砖块游戏模式 | 同 **5.1.1 模式启停规则** |

#### 5.2.3 AB 组合键操作（组队/表情包键）
需**同时按压 A、B 键**，根据按压时长触发不同功能：
| 操作方式 | 触发功能 | 反馈说明 |
|----------|----------|----------|
| 短按（＜0.8s） | 切换表情包并无线电发送 | 屏幕循环显示4种表情包，同步发送至同频道组队设备，对方屏幕同步显示 |
| 长按（1-2s） | 发起组队申请 | 屏幕显示「组队中」，播放提示音；组队成功显示爱心图案 |
| 超长按（＞2s） | 查看摩斯密码历史记录 | 屏幕显示 `M:XXXX`（`.` 代表点，`-` 代表划）；无记录显示 `NO REC` |

## 六、 专项功能说明
### 6.1 组队计步功能
1.  **组队机制**：所有设备默认队名 `turtle`、无线电频道 `1`，发起组队后，同频道同队名设备自动响应，组队成功后屏幕显示爱心图案。
2.  **步数同步**：个人步数实时同步至全队，全队总步数为所有成员步数之和，长按 B 键可查看。
3.  **里程碑奖励**：个人步数达到 10/50/100 步时，触发声光提示，并向全队发送「MVP 祝贺」信号，队友设备同步显示祝贺信息。

### 6.2 摩斯密码功能
1.  **发送规则**：短按 A 键发「点」，长按 B 键发「划」（需在代码中补充 B 键发划逻辑，当前版本仅 A 键发点）。
2.  **历史记录**：最多缓存 10 条发送记录，超长按 AB 键查看，记录满后自动覆盖最早条目。
3.  **静音模式**：开启后发送摩斯密码无提示音，右上角指示灯常亮作为静音标识，避免干扰。

### 6.3 低电量提醒功能
当主板电池电压低于 2.0V 时，程序自动触发低电量预警：
1.  屏幕显示红色警告图案与文字 `LOW`。
2.  播放警报提示音，持续 1 秒后自动清空屏幕。
3.  预警间隔为 5 分钟，直至更换电池，避免突然关机导致数据丢失。
### 6.4 其他优化功能
1.摇一摇：切换屏幕亮度（L1 暗 / L2 中 / L3 亮）
2.按住 A 键 + 摇一摇：清空摩斯密码历史记录
3.AB 键超长按 3 秒：清空个人步数 + 全队步数
4.打砖块挡板改为双格，接球更轻松，分数常驻右上角

## 七、 常见问题与解决办法
| 问题现象 | 可能原因 | 解决办法 |
|----------|----------|----------|
| 烧录后主板无响应，屏幕不亮 | 1. 电池没电或数据线接触不良 <br> 2. 代码烧录失败 <br> 3. 主板硬件故障 | 1. 更换电池或重新插拔数据线 <br> 2. 重新烧录 `.hex` 代码文件 <br> 3. 更换主板测试 |
| 计步不准，多计/漏计步数 | 1. 佩戴方式不当，主板晃动幅度过大/过小 <br> 2. 计步阈值不匹配 | 1. 将主板佩戴在手腕上，保持正常走路姿势 <br> 2. 调整代码中 `accZ` 阈值参数（当前为 1300） |
| 组队失败，无法同步步数 | 1. 无线电频道/队名不一致 <br> 2. 设备距离超过有效范围 <br> 3. 未发起组队申请 | 1. 确保所有设备频道为 1、队名为 `turtle` <br> 2. 保持设备间距在 10 米以内 <br> 3. 超长按 AB 键发起组队 |
| 按键无响应，功能无法触发 | 1. 当前处于游戏模式，屏蔽其他功能 <br> 2. 按键操作方式错误 <br> 3. 程序卡顿 | 1. 三击 A 键退出游戏模式 <br> 2. 按说明书要求短按/长按/组合按 <br> 3. 重启主板恢复程序 |
| 游戏中小球速度过快/过慢 | 程序难度升级机制为固定逻辑 | 无需修改，适应不同分数段速度变化；进阶用户可修改代码中速度系数 |


## 八、 设备维护与使用建议
1.  **佩戴方式**：使用专用表带固定主板，避免剧烈晃动或摔落，防止硬件损坏。
2.  **供电管理**：建议使用充电 7 号电池，定期更换，避免低电量使用影响计步精度。
3.  **环境防护**：避免主板接触水、灰尘等污染物，使用后存放于干燥通风处。
4.  **功能扩展**：进阶用户可基于开源代码修改队名、表情包样式、计步阈值等参数，实现个性化定制。

## 九、 免责声明
1.  本项目为开源学习用途，请勿用于商业用途。
2.  因硬件故障、操作不当等非代码原因导致的设备损坏，项目作者不承担责任。
3.  代码使用过程中，若需修改功能，请遵守 micro:bit 官方开源协议。
4.整个项目版权归作者，可以修改发布，但请不要盗取作者代码说自己原创，否则一定追究！！！！

---
**文档版本**：V1.0
**更新日期**：2026-01-11
项目仓库地址：https://github.com/wdgt-bot/microbit-

